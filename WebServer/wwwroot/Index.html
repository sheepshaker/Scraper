<!doctype html>
<html>
<script src="js/angular.min.js"></script>
<script src="js/app/app.module.js"></script>
<script src="js/app/mainCtrl.js"></script>
<script src="js/jquery-2.2.0.min.js"></script>
<script src="js/jquery.signalR-2.2.0.min.js"></script>
<script src="js/angular-signalr-hub.min.js"></script>
<script src="/signalr/hubs"></script>
<script src="js/masonry.pkgd.min.js"></script>
  <head>
<script>


var app = angular.module('myApp', []);
app.controller('GetAllScrapes', function($scope, $http) {
  $http.get('http://82.14.248.46:8010/api/Scraper')
  .then(function(response) {
      $scope.scrapes = response.data;
  });
});
app.controller('TitleController', function($scope){ $scope.title = "Scrapes:"; });

app.controller("AddNewScrape", function ($scope, $http) {

        $scope.SendData = function () {
	    
            var config = {
                headers : {
                    'Content-Type': 'application/x-www-form-urlencoded;charset=utf-8;'
                }
            }

            $http.post("http://82.14.248.46:8010/api/Scraper","=" + $scope.formUrl, config)
            .then(function (response) {
                $scope.PostDataResponse = response.data;
            });
        };
    });
</script>
<LINK REL=StyleSheet HREF="css/masonry-grid.css" TYPE="text/css">
  </head>
  <body ng-app="myApp">

<div ng-controller="AddNewScrape">
    <p>Url: <input type="text" name="formUrl" ng-model="formUrl" required /></p>
    <button ng-click="SendData()">Submit</button>
    <hr />
    {{ PostDataResponse }}
</div>

    <div class="grid" ng-controller="GetAllScrapes">
	
	<div ng-repeat="model in scrapes">
	    <div ng-if="!model.DateCompleted" class="grid-item grid-item--width2 grid-item--height3">
		<p>Name {{model.Name}}</p>
		<p>Url {{model.Url}}</p>
		<p>Progress {{model.Progress}}</p>
		<p>Started {{model.DateStarted}}</p>
		<p>Eta {{model.Eta}}</p>
		</div>
	    <div ng-if="model.DateCompleted" class="grid-item-completed grid-item--width2 grid-item--height3">
		<p>Name {{model.Name}}</p>
		<p>Url {{model.Url}}</p>
		<p>Progress {{model.Progress}}</p>
		<p>Started {{model.DateStarted}}</p>
		<p>Completed {{model.DateCompleted}}</p>
		<p>Elapsed {{model.DateCompleted - model.DateStarted}}</p>
	    </div>
	</div>
    
    </div>
	
    </div>

    <h2 id="username">Chat</h2>
    <div id="userStat"> </div> 
    <div class="container">
        <input type="text" id="message"/>
        <input type="button" id="sendmessage" value="Send"/>
        
	<input type="hidden" id="displayname"/>
        <ul id="discussion"></ul>
        <ul id="time"></ul>
    </div>
<script>
/*
(function(){
// Reference the auto-generated proxy for the hub.
            var chat = $.connection.chatHub;
            // Create a function that the hub can call back to display messages.
            chat.client.addNewMessageToPage = function (name, message) {
                // Add the message to the page.
                $('#discussion').append('<li><strong>' + htmlEncode(name)
                    + '</strong>: ' + htmlEncode(message) + '</li>');
            };

        chat.client.broadcastTime = function (message) {
                // Add the message to the page.
                $('#discussion').append('<li><strong>' + htmlEncode(message) + '</li>');
            };
            // Get the user name and store it to prepend to messages.
            $('#displayname').val(prompt('Enter your name:', ''));
            // Set initial focus to message input box.
            $('#message').focus();
            // Start the connection.
            $.connection.hub.start().done(function () {
                $('#sendmessage').click(function () {
                    // Call the Send method on the hub.
                    chat.server.send($('#displayname').val(), $('#message').val());
                    // Clear text box and reset focus for next comment.
                    $('#message').val('').focus();
                });
            });

})();
*/
</script>
  </body>
</html>


